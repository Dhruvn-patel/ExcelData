<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic-Toc-Tic</title>

    <style>
        * {
            margin: 0;
            padding: 0;
        }

        body {
            font-family: sans-serif;
            background-color: rgb(206, 214, 214);
        }

        .container {
            display: flex;
            justify-content: center;
            text-align: center;
            margin-top: 6%;

        }

        h1 {
            font-size: 30px;
            text-align: center;
            display: block;
            margin-top: 20px;
        }

        td {
            height: 150px;
            width: 150px;
            border: 1px solid black;
            font-size: 100px;
            background-color: black;
            border-color: aliceblue;
            border-radius: 12px;
            color: white;
        }

        .resetbtn {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
            flex-direction: column;

        }

        input[type=button] {
            height: 30px;
            width: 300px;
            cursor: pointer;
            font-size: 20px;
        }

        .display {
            margin-bottom: 50px;
        }

        .wonPlayer {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #showWin {
            font-size: 20px;

        }

        .counter {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
            font-size: 20px;
            margin: 20px;
        }

        span {
            display: inline-block;
        }
    </style>
</head>

<body onload="myfuncnew()">
    <h1 class="title">Tic-Toc-Tic</h1>
    <div class="wonPlayer">
        <p id="ShowWin"></p>

    </div>
    <p id="counter">
        <!-- <p><span id="playerx"></span></p>
        <p><span id="playero"></span></p> -->
    </p>
    <div class="container">
        <table border="1" height="500px " width="50%" cellspacing="0">
            <tr>
                <td id="0"></td>
                <td id="1"></td>
                <td id="2"></td>
            </tr>
            <tr>
                <td id="3"></td>
                <td id="4"></td>
                <td id="5"></td>
            </tr>
            <tr>
                <td id="6"></td>
                <td id="7"></td>
                <td id="8"></td>
            </tr>
        </table>
    </div>
    <div class="resetbtn">
        <p class="display">Player Turn :<span id="cng_player"></span></p>
        <input type="button" id="rstbtn" value="reset">
    </div>
    <script>
        var dhruv_td = document.querySelectorAll('td');
        var dhruv_rst_btn = document.getElementById('rstbtn');
        var dhruv_msg = document.getElementById('cng_player');
        var dhruv_win = document.getElementById('ShowWin');
        dhruv_rst_btn.addEventListener('click', resetValue);
        let total_display = document.getElementById('counter');
        dhruv_td.forEach((val) => {
            val.addEventListener('click', myfun)
        })
        var arr = [
            [0, 1, 2],
            [3, 4, 5],
            [6, 7, 8],
            [0, 3, 6],
            [1, 4, 7],
            [2, 5, 8],
            [0, 4, 8],
            [2, 4, 6],
        ]
        var dhruv_X_text = "X";
        var dhruv_O_text = "O";
        var dhruv_spa = new Array(9).fill(null);
        var dhruv_chnge_player = dhruv_O_text;
        var dhruv_tie = false;
        var dhruv_cnt_tie = 0;
        var flag = true;
        var dhruv_player_x = 0, dhruv_player_O = 0;
        let x_total = 0, y_total = 0;
        function myfun(e) {
            let dhruv_idx = e.target.id;

            if (!dhruv_spa[dhruv_idx]) {
                dhruv_spa[dhruv_idx] = dhruv_chnge_player;
                e.target.innerHTML = dhruv_chnge_player;
                dhruv_cnt_tie++;
                if (win() != false) {
                    let dhruv_arr = win();
                    // dhruv_tie=true;
                    var ans = dhruv_spa[dhruv_arr[0]]
                    flag = false;
                    dhruv_win.innerHTML = `Player Win : ${ans}`;

                    if (ans == "X") {
                        dhruv_player_x = Number(dhruv_player_x) + 1;
                        // localStorage.setItem("playerx", dhruv_player_x);

                    }
                    else {
                        dhruv_player_O = Number(dhruv_player_O) + 1;
                        // localStorage.setItem("playero", dhruv_player_O);

                    }


                    var px_val = document.createElement("p");
                    var py_val = document.createElement("p");
                    px_val.innerHTML = dhruv_player_x
                    py_val.innerHTML = dhruv_player_x
                    total_display.appendChild(px_val);
                    total_display.appendChild(py_val);
                    // setTimeout(function () {

                    //     resetValue();
                    // }, 1000);
                    resetValue()
                    // document.getElementById('playerx').innerHTML = "player x win :" + dhruv_player_x
                    // document.getElementById('playero').innerHTML = " player O win :" + dhruv_player_O
                }
                console.log("count ", dhruv_cnt_tie)
                if (dhruv_cnt_tie == 9 && flag == true) {
                    dhruv_win.innerHTML = "Sorry Try again"
                    dhruv_chnge_player = dhruv_O_text;
                    dhruv_msg.innerHTML = dhruv_O_text;
                }

                dhruv_chnge_player = dhruv_chnge_player == dhruv_X_text ? dhruv_O_text : dhruv_X_text;
                dhruv_msg.innerHTML = dhruv_chnge_player;

            }
        }
        function win() {
            for (let val of arr) {
                let [a, b, c] = val;

                if (dhruv_spa[a] != null && dhruv_spa[b] != null && dhruv_spa[c] != null && dhruv_spa[a] == dhruv_spa[b] && dhruv_spa[a] == dhruv_spa[c]) {
                    console.log(dhruv_spa[a]);
                    return [a, b, c];

                }
            }
            return false;
        }
        function resetValue() {
            dhruv_spa.fill(null);
            dhruv_td.forEach((val) => {
                val.innerHTML = "";
            })
            dhruv_win.innerHTML = ""
            flag == false;
            dhruv_cnt_tie = 0;
            dhruv_chnge_player = dhruv_O_text;
            dhruv_msg.innerHTML = dhruv_O_text;
            return true;
        }

        function myfuncnew() {
            // document.getElementById('playerx').innerHTML = "Previous player x win :" + localStorage.getItem("playerx");
            // document.getElementById('playero').innerHTML = "Previous player O win :" + localStorage.getItem("playero");

        }
    </script>
</body>

</html>